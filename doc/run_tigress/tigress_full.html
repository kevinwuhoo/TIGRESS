<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of tigress_full</title>
  <meta name="keywords" content="tigress_full">
  <meta name="description" content="Complete TIGRESS GRN inference method.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html run_tigress -->
<h1>tigress_full
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>Complete TIGRESS GRN inference method.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function tigress_full(expression_file,tflist_file,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment" style="background-image:url(../brain.png)"><pre class="comment"> Complete TIGRESS GRN inference method.
 Runs the TIGRESS gene regulatory network inference method given 
 expression data and a list of transcription factors. Options can be 
 included (see details below). It outputs a text file containing a 
 ranked list of edges with associated probabilities.
 For more information, please see :
 Haury et al.: 'TIGRESS: Trustful Inference of Gene REgulation using 
 Stability Selection',2012 

 Syntax 1: tigress_full(expression,tflist) % options to default
 Syntax 2: tigress_full(expression, tflist,'option',option_value,...)
 
 REQUIRED INPUTS: 
  - expression_file: a file containing the expression data for all genes. 
  This input should be of the form 'path/expression_file_name'
  - tflist_file: a file containing the list of transcription factors. This
  input should be of the form 'path/expression_file_name'

 OPTIONAL INPUTS:
  - R: number of resampling runs (default 1000)
  - L: number of LARS steps at each iteration (default:5)
  - alpha: randomization parameter alpha (in ]0,1]) (def:0.2)
  - method: either 'original' or 'area' (default: 'area')
  - cutoff: number of edges to predict (default: Inf)
  - verbose: do you want the algorithm to show you the progress? 
            (default=true)
  - name_net: path/name.ext of file to write network into.
              (Default='./edges.txt')

 OUTPUT:
 A file name 'edges.txt' that writes itself in the working directory.
 It contains 3 columns:
 - 1st column: transcription factors
 - 2nd column: target genes
 - 3rd column: probability of edge existence
 Note that the file is output such that the probabilities are ranked
 decreasingly.
 
 Example:
 tigress_full(expression_file,tflist_file,'L',3,'R',500,'verbose',false)

 See also: <a href="tigress.html" class="code" title="function freq=tigress(data,varargin)">tigress</a>.m, <a href="score_edges.html" class="code" title="function scores = score_edges(freq,varargin)">score_edges</a>.m, <a href="predict_network.html" class="code" title="function edges=predict_network(scores,tf_index,varargin)">predict_network</a>.m

 Anne-Claire Haury, 2012</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment" style="background-image:url(../brain.png)">
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="predict_network.html" class="code" title="function edges=predict_network(scores,tf_index,varargin)">predict_network</a>	Create list of predicted edges and optionally print them in a text file</li><li><a href="read_data.html" class="code" title="function data=read_data(expression_file,tflist_file)">read_data</a>	Transforms data from files into a structure</li><li><a href="score_edges.html" class="code" title="function scores = score_edges(freq,varargin)">score_edges</a>	Transforms frequencies into scores</li><li><a href="tigress.html" class="code" title="function freq=tigress(data,varargin)">tigress</a>	Runs tigress and returns the frequency matrix</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
</div>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment" style="background-image:url(../brain.png)"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function tigress_full(expression_file,tflist_file,varargin)</a>
0002 
0003 <span class="comment">% Complete TIGRESS GRN inference method.</span>
0004 <span class="comment">% Runs the TIGRESS gene regulatory network inference method given</span>
0005 <span class="comment">% expression data and a list of transcription factors. Options can be</span>
0006 <span class="comment">% included (see details below). It outputs a text file containing a</span>
0007 <span class="comment">% ranked list of edges with associated probabilities.</span>
0008 <span class="comment">% For more information, please see :</span>
0009 <span class="comment">% Haury et al.: 'TIGRESS: Trustful Inference of Gene REgulation using</span>
0010 <span class="comment">% Stability Selection',2012</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% Syntax 1: tigress_full(expression,tflist) % options to default</span>
0013 <span class="comment">% Syntax 2: tigress_full(expression, tflist,'option',option_value,...)</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% REQUIRED INPUTS:</span>
0016 <span class="comment">%  - expression_file: a file containing the expression data for all genes.</span>
0017 <span class="comment">%  This input should be of the form 'path/expression_file_name'</span>
0018 <span class="comment">%  - tflist_file: a file containing the list of transcription factors. This</span>
0019 <span class="comment">%  input should be of the form 'path/expression_file_name'</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% OPTIONAL INPUTS:</span>
0022 <span class="comment">%  - R: number of resampling runs (default 1000)</span>
0023 <span class="comment">%  - L: number of LARS steps at each iteration (default:5)</span>
0024 <span class="comment">%  - alpha: randomization parameter alpha (in ]0,1]) (def:0.2)</span>
0025 <span class="comment">%  - method: either 'original' or 'area' (default: 'area')</span>
0026 <span class="comment">%  - cutoff: number of edges to predict (default: Inf)</span>
0027 <span class="comment">%  - verbose: do you want the algorithm to show you the progress?</span>
0028 <span class="comment">%            (default=true)</span>
0029 <span class="comment">%  - name_net: path/name.ext of file to write network into.</span>
0030 <span class="comment">%              (Default='./edges.txt')</span>
0031 <span class="comment">%</span>
0032 <span class="comment">% OUTPUT:</span>
0033 <span class="comment">% A file name 'edges.txt' that writes itself in the working directory.</span>
0034 <span class="comment">% It contains 3 columns:</span>
0035 <span class="comment">% - 1st column: transcription factors</span>
0036 <span class="comment">% - 2nd column: target genes</span>
0037 <span class="comment">% - 3rd column: probability of edge existence</span>
0038 <span class="comment">% Note that the file is output such that the probabilities are ranked</span>
0039 <span class="comment">% decreasingly.</span>
0040 <span class="comment">%</span>
0041 <span class="comment">% Example:</span>
0042 <span class="comment">% tigress_full(expression_file,tflist_file,'L',3,'R',500,'verbose',false)</span>
0043 <span class="comment">%</span>
0044 <span class="comment">% See also: tigress.m, score_edges.m, predict_network.m</span>
0045 <span class="comment">%</span>
0046 <span class="comment">% Anne-Claire Haury, 2012</span>
0047 
0048 <span class="comment">%% Parse arguments</span>
0049 p = inputParser;   <span class="comment">% Create an instance of the class.</span>
0050 p.addRequired(<span class="string">'expression_file'</span>, @ischar);
0051 p.addRequired(<span class="string">'tflist_file'</span>, @ischar);
0052 p.addParamValue(<span class="string">'L'</span>, 5, @isfloat);
0053 p.addParamValue(<span class="string">'R'</span>, 1000, @isfloat);
0054 p.addParamValue(<span class="string">'alpha'</span>, .2, @(x)x&gt;0 &amp;&amp; x&lt;=1);
0055 p.addParamValue(<span class="string">'method'</span>,<span class="string">'area'</span>,@(x)any(strcmpi(x,{<span class="string">'area'</span>,<span class="string">'original'</span>})));
0056 p.addParamValue(<span class="string">'cutoff'</span>, Inf, @isfloat);
0057 p.addParamValue(<span class="string">'verbose'</span>,true,@islogical);
0058 p.addParamValue(<span class="string">'name_net'</span>,<span class="string">'./edges.txt'</span>,@isstr);
0059 p.parse(<span class="string">'expression_file'</span>,<span class="string">'tflist_file'</span>,varargin{:})
0060 
0061 <span class="comment">%% Show which arguments were not specified in the call.</span>
0062 disp(<span class="string">' '</span>) 
0063 disp <span class="string">'List of arguments given default values:'</span> 
0064 <span class="keyword">for</span> k=1:numel(p.UsingDefaults)
0065    field = char(p.UsingDefaults(k));
0066    value = num2str(p.Results.(field));
0067    <span class="keyword">if</span> isempty(value)   
0068        value = <span class="string">'[]'</span>;   
0069    <span class="keyword">end</span>
0070    fprintf(<span class="string">'   ''%s''    defaults to %s \n'</span>, field, value)
0071 <span class="keyword">end</span>
0072  
0073 <span class="comment">%% Read inputs</span>
0074 data=<a href="read_data.html" class="code" title="function data=read_data(expression_file,tflist_file)">read_data</a>(expression_file,tflist_file);
0075 
0076 <span class="comment">%% Get frequency matrix F</span>
0077 freq=<a href="tigress.html" class="code" title="function freq=tigress(data,varargin)">tigress</a>(data,<span class="string">'L'</span>,p.Results.L,<span class="string">'R'</span>,p.Results.R,<span class="string">'alpha'</span>,<span class="keyword">...</span>
0078     p.Results.alpha,<span class="string">'verbose'</span>,p.Results.verbose);
0079 
0080 <span class="comment">%% Get scores</span>
0081 scores=<a href="score_edges.html" class="code" title="function scores = score_edges(freq,varargin)">score_edges</a>(freq,<span class="string">'method'</span>,p.Results.method,<span class="string">'L'</span>,p.Results.L);
0082 
0083 <span class="comment">%% Write edges</span>
0084 <a href="predict_network.html" class="code" title="function edges=predict_network(scores,tf_index,varargin)">predict_network</a>(scores,data.tf_index,<span class="string">'genenames'</span>,data.genenames,<span class="keyword">...</span>
0085     <span class="string">'cutoff'</span>,p.Results.cutoff,<span class="string">'name_net'</span>,p.Results.name_net);</pre></div>
<hr><address>Generated on Thu 09-Feb-2012 19:48:51 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>